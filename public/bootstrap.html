<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Bootstrap Master Admin</title>
  </head>
  <body>
    <h1>Bootstrap Master Admin</h1>
    <p>Ensure <code>ENABLE_MASTER_BOOTSTRAP=true</code> and a file <code>.bootstrap_token</code> exists in repo root.</p>
    <form id="adminForm">
      <input name="name" placeholder="Full name" required /><br/>
      <input name="email" placeholder="Email" required /><br/>
      <input name="phone" placeholder="Phone" required /><br/>
      <input name="password" type="password" placeholder="Password" required /><br/>
      <input name="token" placeholder="Bootstrap token" required /><br/>
      <button type="submit">Create Master Admin</button>
    </form>
    <hr/>
    <h2>Seed Masters</h2>
    <form id="seedForm">
      <input name="token" placeholder="Bootstrap token" required /><br/>
      <button type="submit">Run Master Seeds</button>
    </form>

    <script>
      document.getElementById('adminForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const f = e.target;
        const body = { name: f.name.value, email: f.email.value, phone: f.phone.value, password: f.password.value };
        const token = f.token.value;
        const res = await fetch('/api/v1/admin/master-admin', { method: 'POST', headers: { 'Content-Type': 'application/json', 'x-bootstrap-token': token }, body: JSON.stringify(body) });
        const j = await res.json();
        alert(JSON.stringify(j));
      });

      document.getElementById('seedForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const f = e.target;
        const token = f.token.value;
        const res = await fetch('/api/v1/bootstrap/masters', { method: 'POST', headers: { 'Content-Type': 'application/json', 'x-bootstrap-token': token } });
        const j = await res.json();
        alert(JSON.stringify(j));
      });
    </script>
  </body>
</html>
